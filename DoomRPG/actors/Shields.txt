actor DRPGShield : Inventory
{
    Inventory.Amount 1
    Inventory.MaxAmount 1
}

actor DRPGShieldCapacity : Inventory            { Inventory.MaxAmount 100 }
actor DRPGShieldCharge : Inventory              { Inventory.MaxAmount 1000000 }
actor DRPGShieldChargeMax : Inventory           { Inventory.MaxAmount 1000000 }

// Shield On/Off Items
actor DRPGShieldOn : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("NOBLOOD", true)
        Stop
    }
}

actor DRPGShieldOff : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("NOBLOOD", false)
        Stop
    }
}

// Shield Accessory Powerups
actor DRPGShieldLightAmp : PowerupGiver
{
    -INVBAR
    +INVENTORY.AUTOACTIVATE
    
    Powerup.Type LightAmp
    Powerup.Duration -0x7FFFFFFF
}

actor DRPGShieldInvisibility : PowerupGiver
{
    -INVBAR
    +INVENTORY.AUTOACTIVATE
    
    Powerup.Type Invisibility
    Powerup.Duration -0x7FFFFFFF
}

actor DRPGShieldGhost : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("GHOST", true)
        TNT1 A 0 A_SetTranslucent(0.5, 1)
        Stop
    }
}

actor DRPGShieldGhostOff : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("GHOST", false)
        TNT1 A 0 A_SetTranslucent(1.0, 0)
        Stop
    }
}

actor DRPGShieldTimeFreezer : PowerupGiver
{
    -INVBAR
    +INVENTORY.AUTOACTIVATE
    
    Powerup.Type TimeFreezer
    Powerup.Duration -0x7FFFFFFF
}

actor DRPGShieldReflection : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("REFLECTIVE", true)
        Stop
    }
}

actor DRPGShieldReflectionOff : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    States
    {
    Pickup:
        TNT1 A 0 A_ChangeFlag("REFLECTIVE", false)
        Stop
    }
}

// Shield Booster
actor DRPGShieldBooster : CustomInventory 20080
{
    Scale 0.5
    
    Inventory.PickupMessage "Got a Shield Booster!"
    Inventory.PickupSound "shield/booster"
    
    States
    {
    Spawn:
        SBST A 0 Bright NoDelay A_SpawnItemEx("DRPGShieldBoosterBeam", 0, 0, 0, 0, 0, 0, 0, SXF_SETMASTER)
        SBST A -1 Bright
        Stop
    Pickup:
        SBST A 0 ACS_NamedExecute("AddShield", 0, ACS_NamedExecuteWithResult("GetShieldMax", 0) / 10)
        Stop
    }
}

actor DRPGShieldBoosterBeam
{
    Scale 0.25
    Alpha 0.75
    RenderStyle Add
    
    +FORCEYBILLBOARD
    
    Translation "0 : 255 = %[0.0, 0.0, 0.0] : [0.0, 0.25, 0.75]"
    
    var int user_step;
    
    States
    {
    Spawn:
    FadeLoop:
        BEAM A 1 Bright
        TNT1 A 0 A_Warp(AAPTR_MASTER, 0, 0, 0, 0, WARPF_NOCHECKPOSITION | WARPF_TOFLOOR | WARPF_COPYINTERPOLATION)
        TNT1 A 0 A_SetTranslucent(0.5 + (0.25 * Sin(user_step)), 1)
        TNT1 A 0 A_SetUserVar("user_step", user_step + 10.285714)
        TNT1 A 0 A_Warp(AAPTR_MASTER, 0, 0, 0, 0, WARPF_NOCHECKPOSITION | WARPF_TESTONLY, "FadeLoop")
    Death:
        TNT1 A 1
        Stop
    }
}

// Basic Shield Package
actor DRPGBasicShieldPackage : CustomInventory
{
    +INVENTORY.AUTOACTIVATE
    
    Inventory.PickupMessage "You got a Basic Shield Package."
    Inventory.PickupSound "shield/pickup"
    
    Scale 0.5
    
    States
    {
    Spawn:
        SHPA A -1 Bright
        Stop
    Use:
        TNT1 A 0 A_GiveInventory("DRPGShieldBody1", 1)
        TNT1 A 0 A_GiveInventory("DRPGShieldBattery1", 1)
        TNT1 A 0 A_GiveInventory("DRPGShieldCapacitor1", 1)
        Stop
    }
}

actor DRPGShieldPart : Inventory
{
    Scale 0.5
    
    Inventory.MaxAmount 100
    Inventory.InterHubAmount 100
    Inventory.PickupMessage "Got a Shield Part!"
    Inventory.PickupSound "shield/pickup"

    States
    {
    Spawn:
        SHCA A -1 Bright
        Stop
    Pickup:
        SHCA A 0
        Stop
    }
}

// BODIES
//

actor DRPGShieldBody1 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO A -1 Bright
        Stop
    }
}

actor DRPGShieldBody2 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO B -1 Bright
        Stop
    }
}

actor DRPGShieldBody3 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO C -1 Bright
        Stop
    }
}

actor DRPGShieldBody4 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO D -1 Bright
        Stop
    }
}

actor DRPGShieldBody5 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO E -1 Bright
        Stop
    }
}

actor DRPGShieldBody6 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO F -1 Bright
        Stop
    }
}

actor DRPGShieldBody7 : DRPGShieldPart
{
    Inventory.PickupSound "shield/bisonpickup"
    
    States
    {
    Spawn:
        SHBO G -1 Bright
        Stop
    }
}

actor DRPGShieldBody8 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO H -1 Bright
        Stop
    }
}

actor DRPGShieldBody9 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO I -1 Bright
        Stop
    }
}

actor DRPGShieldBody10 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO J -1 Bright
        Stop
    }
}

actor DRPGShieldBody11 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO K -1 Bright
        Stop
    }
}

actor DRPGShieldBody12 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO L -1 Bright
        Stop
    }
}

actor DRPGShieldBody13 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO M -1 Bright
        Stop
    }
}

actor DRPGShieldBody14 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO N -1 Bright
        Stop
    }
}

actor DRPGShieldBody15 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO O -1 Bright
        Stop
    }
}

actor DRPGShieldBody16 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO P -1 Bright
        Stop
    }
}

actor DRPGShieldBody17 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO Q -1 Bright
        Stop
    }
}

actor DRPGShieldBody18 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO R -1 Bright
        Stop
    }
}

actor DRPGShieldBody19 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO S -1 Bright
        Stop
    }
}

actor DRPGShieldBody20 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO T -1 Bright
        Stop
    }
}

actor DRPGShieldBody21 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO U -1 Bright
        Stop
    }
}

actor DRPGShieldBody22 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBO V -1 Bright
        Stop
    }
}

// BATTERIES
//

actor DRPGShieldBattery1 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA A -1 Bright
        Stop
    }
}

actor DRPGShieldBattery2 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA B -1 Bright
        Stop
    }
}

actor DRPGShieldBattery3 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA C -1 Bright
        Stop
    }
}

actor DRPGShieldBattery4 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA D -1 Bright
        Stop
    }
}

actor DRPGShieldBattery5 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA E -1 Bright
        Stop
    }
}

actor DRPGShieldBattery6 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA F -1 Bright
        Stop
    }
}

actor DRPGShieldBattery7 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA G -1 Bright
        Stop
    }
}

actor DRPGShieldBattery8 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA H -1 Bright
        Stop
    }
}

actor DRPGShieldBattery9 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA I -1 Bright
        Stop
    }
}

actor DRPGShieldBattery10 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA J -1 Bright
        Stop
    }
}

actor DRPGShieldBattery11 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA K -1 Bright
        Stop
    }
}

actor DRPGShieldBattery12 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA L -1 Bright
        Stop
    }
}

actor DRPGShieldBattery13 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHBA M -1 Bright
        Stop
    }
}

// CAPACITORS
// 

actor DRPGShieldCapacitor1 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA A -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor2 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA B -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor3 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA C -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor4 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA D -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor5 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA E -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor6 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA F -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor7 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA G -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor8 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA H -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor9 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA I -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor10 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA J -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor11 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA K -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor12 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA L -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor13 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA M -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor14 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA N -1 Bright
        Stop
    }
}

actor DRPGShieldCapacitor15 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHCA O -1 Bright
        Stop
    }
}

// ACCESSORIES
// 

actor DRPGShieldAccessory1 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC A -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory2 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC B -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory3 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC C -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory4 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC D -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory5 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC E -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory6 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC F -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory7 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC G -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory8 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC H -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory9 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC I -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory10 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC J -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory11 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC K -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory12 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC L -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory13 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC M -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory14 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC N -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory15 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC O -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory16 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC P -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory17 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC Q -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory18 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC R -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory19 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC S -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory20 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC T -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory21 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC U -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory22 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC V -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory23 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC W -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory24 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC X -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory25 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC Y -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory26 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHAC Z -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory27 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHA2 A -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory28 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHA2 B -1 Bright
        Stop 
    }
}

actor DRPGShieldAccessory29 : DRPGShieldPart
{
    States
    {
    Spawn:
        SHA2 C -1 Bright
        Stop 
    }
}
